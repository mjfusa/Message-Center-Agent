# Local environment variables for the external MCP server (DO NOT commit real secrets)
#
# Usage (PowerShell):
#   Get-Content .\mcp-message-center-server\.env.local | ForEach-Object { if($_ -match '^(.*?)=(.*)$'){ [System.Environment]::SetEnvironmentVariable($matches[1], $matches[2]) } }
#   node .\mcp-message-center-server\dist\server.js

# Server
PORT=8080
PUBLIC_BASE_URL=http://localhost:8080

# Microsoft Entra (App Registration)
# Create an App Registration and fill these values:
GRAPH_TENANT_ID=
GRAPH_CLIENT_ID=

# Choose ONE of the following credential options for Graph OBO:
# 1) Local/dev fallback (client secret)
# GRAPH_CLIENT_SECRET=

# 2) Preferred for Azure-hosted deployments: certificate private key in Key Vault, loaded via managed identity
# The Key Vault secret value should be the PEM private key, or JSON like {"privateKey":"..."}.
GRAPH_CLIENT_CERT_KEYVAULT_URL=
GRAPH_CLIENT_CERT_SECRET_NAME=graph-client-cert
# Optional: pin a specific version
# GRAPH_CLIENT_CERT_SECRET_VERSION=
GRAPH_CLIENT_CERT_THUMBPRINT=

# Allowlist for /authorize and /token redirect_uri validation.
# Defaults include VS Code loopback + Teams declarative-agent redirect.
# If you need to customize, set comma-separated prefixes.
# MCP_OAUTH_REDIRECT_URI_PREFIXES=http://127.0.0.1,http://localhost,https://teams.microsoft.com/api/platform/v1.0/oAuthRedirect

# VS Code OAuth (Authorization Code + PKCE) proxy endpoints
# VS Code expects your server to expose /authorize and /token. This server proxies those calls to Entra.
# By default, /authorize requests: openid profile offline_access api://<clientId>/access_as_user
# You can override/lock down with the following:

# Optional: tenant id override for VS Code auth (defaults to GRAPH_TENANT_ID)
MCP_OAUTH_TENANT_ID=

# Optional: explicitly require a specific client id (defaults to GRAPH_CLIENT_ID)
MCP_OAUTH_EXPECTED_CLIENT_ID=

# Optional: comma-separated allowed redirect URI prefixes (defaults to http://127.0.0.1,http://localhost)
MCP_OAUTH_REDIRECT_URI_PREFIXES=http://127.0.0.1,http://localhost

# Optional: override scopes requested at /authorize
MCP_OAUTH_SCOPES=

# Optional: override client secret for /token (defaults to GRAPH_CLIENT_SECRET)
# If neither MCP_OAUTH_CLIENT_SECRET nor GRAPH_CLIENT_SECRET is set, /token will use the
# certificate settings above (Key Vault + GRAPH_CLIENT_CERT_*).
MCP_OAUTH_CLIENT_SECRET=
